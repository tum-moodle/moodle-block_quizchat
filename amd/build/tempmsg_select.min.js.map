{"version":3,"file":"tempmsg_select.min.js","sources":["../src/tempmsg_select.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript library for the block_quizchat plugin.\n *\n * @package\n * @copyright 2023, TUM ProLehre | Medien und Didaktik <moodle@tum.de>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport * as Notification from 'core/notification';\nimport {call as fetchMany} from 'core/ajax';\n\nexport const list = (query,quizchatid, centraltempflag) => {\n    return fetchMany([{\n        methodname: 'block_quizchat_get_template_messages',\n        args: {\n            templateid: null,\n            onlyenabled: true,\n            quizchatid: quizchatid,\n            partial_name: query,\n            centraltempflag: centraltempflag\n        }\n    }])[0].then(response => {\n        // response.data is array of arrays\n        const data = response || [];\n        // Define keys\n        const keys = [\"actions\", \"title\", \"message\", \"status\", \"user\", \"date\", \"id\", \"isenabled\"];\n        // Convert to array of objects\n        const objects = data.map(item => Object.fromEntries(keys.map((key, i) => [key, item[i]])));\n\n        return objects;\n    });\n};\n\nexport const processResults = (selector, results) => {\n    var options = [];\n    results.forEach(temp => {\n        options.push({\n            value: String(temp.id) + '\" ' + 'data-tempmsg=\"' + temp.message.replace(/<[^>]*>/g, '').trim() + '\"' ,\n            label: temp.title.replace(/<[^>]*>/g, '').trim()\n        });\n    });\n    return options;\n};\n\nexport const transport = (selector, query, callback) => {\n    const qcInput = document.getElementById('id_block_quizchat_quizchatid');\n    const centraltemp = document.getElementsByName('block_quizchat_usecentraltempmsgs')[0];\n    const quizchatid = qcInput ? parseInt(qcInput.value) : null;\n    const centraltempflag = centraltemp ? parseInt(centraltemp.value) : null;\n    list(query, quizchatid, centraltempflag).then(callback).catch(Notification.exception);\n};\n"],"names":["list","query","quizchatid","centraltempflag","methodname","args","templateid","onlyenabled","partial_name","then","response","keys","map","item","Object","fromEntries","key","i","selector","results","options","forEach","temp","push","value","String","id","message","replace","trim","label","title","callback","qcInput","document","getElementById","centraltemp","getElementsByName","parseInt","catch","Notification","exception"],"mappings":";;;;;;;0BAyBaA,KAAO,CAACC,MAAMC,WAAYC,mBAC5B,cAAU,CAAC,CACdC,WAAY,uCACZC,KAAM,CACFC,WAAY,KACZC,aAAa,EACbL,WAAYA,WACZM,aAAcP,MACdE,gBAAiBA,oBAErB,GAAGM,MAAKC,iBAIFC,KAAO,CAAC,UAAW,QAAS,UAAW,SAAU,OAAQ,OAAQ,KAAM,oBAFhED,UAAY,IAIJE,KAAIC,MAAQC,OAAOC,YAAYJ,KAAKC,KAAI,CAACI,IAAKC,IAAM,CAACD,IAAKH,KAAKI,uDAM9D,CAACC,SAAUC,eACjCC,QAAU,UACdD,QAAQE,SAAQC,OACZF,QAAQG,KAAK,CACTC,MAAOC,OAAOH,KAAKI,IAAZD,mBAA4CH,KAAKK,QAAQC,QAAQ,WAAY,IAAIC,OAAS,IACjGC,MAAOR,KAAKS,MAAMH,QAAQ,WAAY,IAAIC,YAG3CT,4BAGc,CAACF,SAAUjB,MAAO+B,kBACjCC,QAAUC,SAASC,eAAe,gCAClCC,YAAcF,SAASG,kBAAkB,qCAAqC,GAC9EnC,WAAa+B,QAAUK,SAASL,QAAQT,OAAS,KACjDrB,gBAAkBiC,YAAcE,SAASF,YAAYZ,OAAS,KACpExB,KAAKC,MAAOC,WAAYC,iBAAiBM,KAAKuB,UAAUO,MAAMC,aAAaC"}